<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DungeonDice_MockUp</title>
    <style>
        html, body {
            background: Black;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        #gameContainer {
            width: 1280px;
            height: 720px;
            position: relative;
            background: transparent !important;
            transform-origin: top left; /* scale 기준점 */
        }
        #unity-canvas {
            width: 1280px !important;
            height: 720px !important;
            position: absolute;
            top: 0;
            left: 0;
        }
        #unity-canvas[data-pixel-art="true"] {
            image-rendering: optimizeSpeed;
            image-rendering: -webkit-crisp-edges;
            image-rendering: -moz-crisp-edges;
            image-rendering: -o-crisp-edges;
            image-rendering: crisp-edges;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: optimize-contrast;
            image-rendering: pixelated;
            -ms-interpolation-mode: nearest-neighbor;
        }
    </style>
    <script>
        document.onmousedown = function(){ window.focus(); };
    </script>
    <script>
        // shrink-to-fit=no → iOS 자동 축소 방지
        (function(){
            const meta = document.createElement('meta');
            meta.name = 'viewport';
            meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=no';
            document.head.appendChild(meta);
        })();
    </script>
</head>
<body>
<div id="gameContainer">
    <canvas id="unity-canvas" data-pixel-art="true"></canvas>
</div>

<script src="Build/WebGL.loader.js"></script>
<script>
    var canvas = document.querySelector('#unity-canvas');
    var container = document.querySelector('#gameContainer');

    var config = {
        dataUrl: "Build/WebGL.data",
        frameworkUrl: "Build/WebGL.framework.js",
        codeUrl: "Build/WebGL.wasm",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "MilestoneGames",
        productName: "DungeonDice_MockUp",
        productVersion: "6.1.5",
        devicePixelRatio: 1 // DPR 고정 → 갑자기 작아지는 문제 방지
    };

    function progressHandler(progress) {
        var percent = (progress * 100) + '%';
        canvas.style.background =
            'linear-gradient(to right, white, white ' + percent +
            ', transparent ' + percent + ', transparent) no-repeat center';
        canvas.style.backgroundSize = '100% 1rem';
    }

    function lockCanvasSize() {
        // CSS 기본 크기
        canvas.style.width  = "1280px";
        canvas.style.height = "720px";
        canvas.width  = 1280;
        canvas.height = 720;

        // PC는 고정
        if (!/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
            container.style.transform = "scale(1)";
            return;
        }

        // 모바일만 축소 허용
        var scaleX = window.innerWidth  / 1280;
        var scaleY = window.innerHeight / 720;
        var scale = Math.min(scaleX, scaleY, 1); // 1 이하일 때만 축소
        container.style.transform = "scale(" + scale + ")";
    }

    createUnityInstance(canvas, config, progressHandler).then(function (instance) {
        window.unityInstance = instance;
        lockCanvasSize();
        window.addEventListener('resize', lockCanvasSize);
        window.addEventListener('orientationchange', lockCanvasSize);
        window.addEventListener('pageshow', lockCanvasSize);
    });
</script>
</body>
</html>
